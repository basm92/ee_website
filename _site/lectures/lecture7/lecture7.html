<!DOCTYPE html>
<html lang="en"><head>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.54">

  <title>Empirical Economics</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto.css">
  <link rel="stylesheet" href="styles.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Empirical Economics</h1>
  <p class="subtitle">Lecture 7: Potential Outcomes and Difference-in-differences</p>

<div class="quarto-title-authors">
</div>

</section>
<section>
<section id="outline" class="title-slide slide level1 center">
<h1>Outline</h1>

</section>
<section id="course-overview" class="slide level2">
<h2>Course Overview</h2>
<ul>
<li>Statistics and Probability - Basic Concepts</li>
<li>Statistics and Probability - Hypothesis Testing</li>
<li>The Linear Regression Model</li>
<li>Time Series Data</li>
<li>Panel Data (FE) and Control Variables</li>
<li>Binary Outcome Data</li>
<li>Potential Outcomes and Difference-in-differences</li>
<li>Hands-on Econometrics in Practice</li>
</ul>
</section>
<section id="what-do-we-do-today" class="slide level2">
<h2>What do we do today?</h2>
</section></section>
<section>
<section id="potential-outcomes" class="title-slide slide level1 center">
<h1>Potential Outcomes</h1>

</section>
<section id="correlation-vs.-causality" class="slide level2">
<h2>Correlation vs.&nbsp;Causality</h2>
<ul>
<li><p>The fundamental challenge in empirical work.</p></li>
<li><p><strong>Correlation:</strong> Two variables move together.</p>
<ul>
<li><em>Example:</em> Ice cream sales are positively correlated with crime rates.</li>
</ul></li>
<li><p><strong>Causation:</strong> A change in one variable <em>causes</em> a change in another.</p>
<ul>
<li><em>Does eating ice cream cause crime?</em> Unlikely.</li>
</ul></li>
<li><p><strong>Confounding Variable:</strong> A third variable affects both.</p>
<ul>
<li><em>Hot weather</em> increases both ice cream sales and the number of people outside (leading to more opportunities for crime).</li>
</ul></li>
<li><p>Our goal is to isolate the causal effect, not just the correlation.</p></li>
</ul>
</section>
<section id="the-potential-outcomes-framework" class="slide level2">
<h2>The Potential Outcomes Framework</h2>
<ul>
<li><p>Also known as the <strong>Rubin Causal Model</strong>.</p></li>
<li><p>Let’s think about the effect of a treatment (e.g., a job training program) on an individual <em>i</em>.</p></li>
<li><p><span class="math inline">\(Y_i(1)\)</span>: The potential outcome for unit <em>i</em> <strong>if they receive the treatment</strong>.</p></li>
<li><p><span class="math inline">\(Y_i(0)\)</span>: The potential outcome for unit <em>i</em> <strong>if they do NOT receive the treatment</strong>.</p></li>
</ul>
<div title="Example: Potential Outcomes">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Example: Potential Outcomes</strong></p>
</div>
<div class="callout-content">
<p>In the context where the treatment is a job training program:</p>
<p><span class="math inline">\(Y_i(1)\)</span>: A person’s earnings if they attend the program.</p>
<p><span class="math inline">\(Y_i(0)\)</span>: A person’s earnings if they do not attend the program.</p>
</div>
</div>
</div>
</div>
</section>
<section id="the-individual-causal-effect" class="slide level2">
<h2>The Individual Causal Effect</h2>
<ul>
<li>For any single individual <em>i</em>, the true causal effect of the treatment is the difference between their two potential outcomes:</li>
</ul>
<div title="Definition: Individual Causal Effect">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Definition: Individual Causal Effect</strong></p>
</div>
<div class="callout-content">
<p><span class="math display">\[\tau_i = Y_i(1) - Y_i(0)\]</span></p>
</div>
</div>
</div>
</div>
<ul>
<li>This is the pure, unadulterated effect of the treatment on that one person.</li>
<li><em>Example:</em> The increase in Person <em>i</em>’s earnings caused <em>only</em> by the training program.</li>
</ul>
</section></section>
<section>
<section id="from-individuals-to-populations" class="title-slide slide level1 center">
<h1>From Individuals to Populations</h1>

</section>
<section id="the-average-treatment-effect-ate" class="slide level2">
<h2>The Average Treatment Effect (ATE)</h2>
<ul>
<li><p>Since we usually can’t measure the effect for every single individual, we focus on averages.</p></li>
<li><p>The <strong>Average Treatment Effect (ATE)</strong> is the average of the individual causal effects over the entire population.</p>
<ul>
<li>This tells us, “On average, what is the effect of this treatment for a person randomly drawn from the population?”</li>
<li>For future reference, consider also the <strong>Average Treatment Effect</strong> on the treated population:</li>
</ul></li>
</ul>
<div title="Definition: Average Treatment Effect">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Definition: Average Treatment Effect</strong></p>
</div>
<div class="callout-content">
<p><span class="math display">\[\text{ATE} = E[\tau_i] = E[Y(1) - Y(0)]\]</span></p>
<p><span class="math display">\[\text{ATT} = E[\tau_i | T=1] = E[Y(1) - Y(0) | T=1]\]</span></p>
</div>
</div>
</div>
</div>
</section>
<section id="the-fundamental-problem-of-causal-inference" class="slide level2">
<h2>The Fundamental Problem of Causal Inference</h2>
<ul>
<li><p>This is the core challenge that all causal methods try to solve.</p></li>
<li><p><strong>For any given unit <em>i</em>, we can only ever observe <em>one</em> of their potential outcomes.</strong></p>
<ul>
<li>If person <em>i</em> takes the training program, we see <span class="math inline">\(Y_i(1)\)</span>. We will never know what their earnings would have been without it, <span class="math inline">\(Y_i(0)\)</span>.</li>
<li>If person <em>i</em> does not take the program, we see <span class="math inline">\(Y_i(0)\)</span>. We will never know <span class="math inline">\(Y_i(1)\)</span>.</li>
</ul></li>
<li><p>Causal inference is a <strong>missing data problem</strong>. The <span class="math inline">\(Y_i(0)\)</span> for the treated and the <span class="math inline">\(Y_i(1)\)</span> for the untreated are called <strong>counterfactuals</strong>.</p></li>
</ul>
</section>
<section id="illustrating-the-fundamental-problem" class="slide level2">
<h2>Illustrating the Fundamental Problem</h2>
<ul>
<li>The following illustrates the data we have at our disposal.</li>
</ul>
<div style="font-size: 1.5em;">
<table class="caption-top">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Unit (i)</th>
<th style="text-align: center;">Attends Program?</th>
<th style="text-align: center;">Observed Earnings</th>
<th style="text-align: center;"><span class="math inline">\(Y_i(1)\)</span></th>
<th style="text-align: center;"><span class="math inline">\(Y_i(0)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Alice</td>
<td style="text-align: center;">Yes (T=1)</td>
<td style="text-align: center;">$50,000</td>
<td style="text-align: center;">$50,000</td>
<td style="text-align: center;"><strong>???</strong></td>
</tr>
<tr class="even">
<td style="text-align: center;">Bob</td>
<td style="text-align: center;">No (T=0)</td>
<td style="text-align: center;">$40,000</td>
<td style="text-align: center;"><strong>???</strong></td>
<td style="text-align: center;">$40,000</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Carol</td>
<td style="text-align: center;">Yes (T=1)</td>
<td style="text-align: center;">$45,000</td>
<td style="text-align: center;">$45,000</td>
<td style="text-align: center;"><strong>???</strong></td>
</tr>
<tr class="even">
<td style="text-align: center;">David</td>
<td style="text-align: center;">No (T=0)</td>
<td style="text-align: center;">$60,000</td>
<td style="text-align: center;"><strong>???</strong></td>
<td style="text-align: center;">$60,000</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li>We can’t calculate <span class="math inline">\(Y_i(1) - Y_i(0)\)</span> for anyone!</li>
</ul>
</section></section>
<section>
<section id="motivation-for-did" class="title-slide slide level1 center">
<h1>Motivation for DiD</h1>

</section>
<section id="why-simple-comparisons-fail" class="slide level2">
<h2>Why Simple Comparisons Fail</h2>
<ul>
<li><p>A naive approach might be to just compare the average earnings of those who attended the program to those who didn’t.</p>
<p><span class="math display">\[
  \text{Difference-in-means} = E[Y | T=1] - E[Y | T=0]
\]</span></p></li>
<li><p>This is almost always <strong>wrong</strong>. Why?</p></li>
<li><p>Because the people who <em>choose</em> to get treatment might be different from those who don’t in ways that also affect the outcome.</p></li>
<li><p>This is referred to as <strong>Selection Bias</strong></p></li>
</ul>
</section>
<section id="selection-bias-the-hidden-difference" class="slide level2">
<h2>Selection Bias: The Hidden Difference</h2>
<ul>
<li>The simple difference-in-means can be decomposed:</li>
</ul>
<div style="font-size: 0.7em;">
<p><span class="math display">\[\begin{align*}
    \text{Difference-in-means} &amp;= E[Y|T=1] - E[Y|T=0] \\
    &amp;= E[Y(1)|T=1] - E[Y(0)|T=0] \\
    &amp;= E[Y(1)|T=1] - \overbrace{E[Y(0)|T=1] + E[Y(0)|T=1]}^{\text{Subtract and add the same term.}} - E[Y(0)|T=0] \\
    &amp;= \underbrace{\left( E[Y(1)|T=1] - E[Y(0)|T=1] \right)}_{\text{Average Treatment Effect on the Treated (ATT)}} \\
     &amp;\quad \quad \hspace{3em} + \underbrace{\left( E[Y(0)|T=1] - E[Y(0)|T=0] \right)}_{\text{Selection Bias}}
\end{align*}\]</span></p>
</div>
<ul>
<li>The selection bias tells you the difference in the untreated potential outcomes between the treatment and control groups.</li>
</ul>
</section>
<section id="selection-bias-decomposition" class="slide level2">
<h2>Selection Bias: Decomposition</h2>
<ul>
<li>Hence, we can make the following decomposition:</li>
</ul>
<div title="Theorem: Decomposition of Sample Average">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Theorem: Decomposition of Sample Average</strong></p>
</div>
<div class="callout-content">
<p><span class="math display">\[E[Y|T=1] - E[Y|T=0] = ATT + \text{Selection Bias},\]</span></p>
<p>where <span class="math inline">\(\text{Selection Bias} = E[Y(0)|T=1] - E[Y(0)|T=0].\)</span></p>
</div>
</div>
</div>
</div>
<ul>
<li>In words, selection bias is the difference in the <strong>no-treatment outcome</strong> between the treated and untreated groups.</li>
<li><em>Job Program Example:</em> People who sign up for training (<span class="math inline">\(T=1\)</span>) might be more motivated. Even without the program, their earnings <span class="math inline">\(Y(0)\)</span> might have been higher than the less motivated group (<span class="math inline">\(T=0\)</span>).</li>
</ul>
</section></section>
<section>
<section id="intro-to-did" class="title-slide slide level1 center">
<h1>Intro to DiD</h1>

</section>
<section id="introduction-to-differences-in-differences-did" class="slide level2">
<h2>Introduction to Differences-in-Differences (DiD)</h2>
<ul>
<li>The core idea in DiD is to use data from a <strong>pre-treatment period</strong> to account for selection bias.
<ul>
<li>We assume that the “selection bias” (the difference between the groups) is constant over time.</li>
</ul></li>
<li>We compare the <em>change</em> in the outcome over time for the treatment group to the <em>change</em> over time for a control group.
<ul>
<li>The “difference in the differences” isolates the treatment effect.</li>
</ul></li>
</ul>
</section>
<section id="the-2-times-2-did-setup" class="slide level2">
<h2>The <span class="math inline">\(2 \times 2\)</span> DiD Setup</h2>
<ul>
<li>The classic setup involves two groups and two time periods.</li>
</ul>
<div style="font-size: 1.5em;">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;"><strong>Before Period (Pre)</strong></th>
<th style="text-align: left;"><strong>After Period (Post)</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Treatment Group</strong></td>
<td style="text-align: left;"><span class="math inline">\(\hat{Y}_{T, Pre}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\hat{Y}_{T, Post}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Control Group</strong></td>
<td style="text-align: left;"><span class="math inline">\(\hat{Y}_{C, Pre}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\hat{Y}_{C, Post}\)</span></td>
</tr>
</tbody>
</table>
</div>
<ul>
<li><strong>Treatment Group:</strong> A group that is exposed to the policy/treatment in the “After” period.</li>
<li><strong>Control Group:</strong> A similar group that is <em>not</em> exposed to the treatment in either period.</li>
</ul>
</section>
<section id="calculating-the-simple-did-estimator" class="slide level2">
<h2>Calculating the Simple DiD Estimator</h2>
<ul>
<li>We calculate two differences, then take the difference between them.</li>
</ul>
<div title="Manual Calculation of DiD Estimator">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Manual Calculation of DiD Estimator</strong></p>
</div>
<div class="callout-content">
<ol type="1">
<li><p><strong>First Difference (Treatment Group):</strong> The change over time for the treated.</p>
<p><span class="math inline">\(\Delta_T = \hat{Y}_{T,Post} - \hat{Y}_{T, Pre}\)</span></p></li>
<li><p><strong>First Difference (Control Group):</strong> The change over time for the controls. This represents the “secular trend” – what would have happened without the treatment.</p>
<p><span class="math inline">\(\Delta_C = \hat{Y}_{C, Post} - \hat{Y}_{C, Pre}\)</span></p></li>
<li><p><strong>The Difference-in-Differences:</strong></p>
<p><span class="math inline">\(\tau_{DiD} = \Delta_T - \Delta_C\)</span></p></li>
</ol>
</div>
</div>
</div>
</div>
</section>
<section id="example-did-in-a-2-times-2-set-up" class="slide level2">
<h2>Example: DiD in a <span class="math inline">\(2 \times 2\)</span> Set-Up</h2>
<div title="Example: Card and Krueger (1994)">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Example: Card and Krueger (1994)</strong></p>
</div>
<div class="callout-content">
<p>The study by Card and Alan Krueger (AER, 1994), titled “Minimum Wages and Employment: A Case Study of the Fast Food Industry in New Jersey and Pennsylvania,” is a landmark paper in labor economics.</p>
<p>It challenged the conventional wisdom that raising the minimum wage necessarily reduces employment.</p>
<p>The authors analyzed the impact of New Jersey’s 1992 minimum wage increase (from $4.25 to $5.05 per hour) by comparing employment changes at fast-food restaurants in New Jersey (where the wage rose) to those in Pennsylvania (where it remained unchanged).</p>
<p>Surprisingly, they found that employment in New Jersey increased by 13% relative to Pennsylvania, contradicting traditional economic predictions</p>
</div>
</div>
</div>
</div>
</section>
<section id="example-did-in-a-2-times-2-set-up-1" class="slide level2">
<h2>Example: DiD in a <span class="math inline">\(2 \times 2\)</span> Set-Up</h2>
<div class="panel-tabset hey">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1">R</a></li><li><a href="#tabset-1-2">Python</a></li><li><a href="#tabset-1-3">Stata</a></li></ul>
<div class="tab-content hey">
<div id="tabset-1-1">
<ul>
<li>Download the Card &amp; Krueger (1994) data:</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="fu">library</span>(tidyverse); <span class="fu">library</span>(fixest)</span>
<span id="cb1-2"><a></a>file_url <span class="ot">&lt;-</span> <span class="st">"https://github.com/mca91/EconometricsWithR/blob/master/data/fastfood.dta?raw=true"</span></span>
<span id="cb1-3"><a></a>card_krueger_data <span class="ot">&lt;-</span> foreign<span class="sc">::</span><span class="fu">read.dta</span>(file_url) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span>
<span id="cb1-4"><a></a><span class="fu">head</span>(card_krueger_data)</span>
<span id="cb1-5"><a></a><span class="do">## # A tibble: 6 × 46</span></span>
<span id="cb1-6"><a></a><span class="do">##   sheet chain co_owned state southj centralj northj   pa1   pa2 shore ncalls</span></span>
<span id="cb1-7"><a></a><span class="do">##   &lt;int&gt; &lt;int&gt;    &lt;int&gt; &lt;int&gt;  &lt;int&gt;    &lt;int&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;  &lt;int&gt;</span></span>
<span id="cb1-8"><a></a><span class="do">## 1    46     1        0     0      0        0      0     1     0     0      0</span></span>
<span id="cb1-9"><a></a><span class="do">## 2    49     2        0     0      0        0      0     1     0     0      0</span></span>
<span id="cb1-10"><a></a><span class="do">## 3   506     2        1     0      0        0      0     1     0     0      0</span></span>
<span id="cb1-11"><a></a><span class="do">## 4    56     4        1     0      0        0      0     1     0     0      0</span></span>
<span id="cb1-12"><a></a><span class="do">## 5    61     4        1     0      0        0      0     1     0     0      0</span></span>
<span id="cb1-13"><a></a><span class="do">## 6    62     4        1     0      0        0      0     1     0     0      2</span></span>
<span id="cb1-14"><a></a><span class="do">## # ℹ 35 more variables: empft &lt;dbl&gt;, emppt &lt;dbl&gt;, nmgrs &lt;dbl&gt;, wage_st &lt;dbl&gt;,</span></span>
<span id="cb1-15"><a></a><span class="do">## #   inctime &lt;dbl&gt;, firstinc &lt;dbl&gt;, bonus &lt;int&gt;, pctaff &lt;dbl&gt;, meals &lt;int&gt;,</span></span>
<span id="cb1-16"><a></a><span class="do">## #   open &lt;dbl&gt;, hrsopen &lt;dbl&gt;, psoda &lt;dbl&gt;, pfry &lt;dbl&gt;, pentree &lt;dbl&gt;,</span></span>
<span id="cb1-17"><a></a><span class="do">## #   nregs &lt;int&gt;, nregs11 &lt;int&gt;, type2 &lt;int&gt;, status2 &lt;int&gt;, date2 &lt;int&gt;,</span></span>
<span id="cb1-18"><a></a><span class="do">## #   ncalls2 &lt;int&gt;, empft2 &lt;dbl&gt;, emppt2 &lt;dbl&gt;, nmgrs2 &lt;dbl&gt;, wage_st2 &lt;dbl&gt;,</span></span>
<span id="cb1-19"><a></a><span class="do">## #   inctime2 &lt;int&gt;, firstin2 &lt;dbl&gt;, special2 &lt;int&gt;, meals2 &lt;int&gt;, open2r &lt;dbl&gt;,</span></span>
<span id="cb1-20"><a></a><span class="do">## #   hrsopen2 &lt;dbl&gt;, psoda2 &lt;dbl&gt;, pfry2 &lt;dbl&gt;, pentree2 &lt;dbl&gt;, nregs2 &lt;int&gt;, …</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>Compute <span class="math inline">\(\tau_{DID}\)</span></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a></a><span class="co"># Treatment group before and after</span></span>
<span id="cb2-2"><a></a>treated <span class="ot">&lt;-</span> card_krueger_data <span class="sc">|&gt;</span></span>
<span id="cb2-3"><a></a>  <span class="fu">filter</span>(state<span class="sc">==</span><span class="dv">1</span>)<span class="sc">|&gt;</span></span>
<span id="cb2-4"><a></a>  <span class="fu">summarize</span>(<span class="at">treated_emp_before =</span> <span class="fu">mean</span>(employment[time<span class="sc">==</span><span class="st">'before'</span>], <span class="at">na.rm=</span>T),</span>
<span id="cb2-5"><a></a>            <span class="at">treated_emp_after =</span> <span class="fu">mean</span>(employment[time<span class="sc">==</span><span class="st">'after'</span>], <span class="at">na.rm=</span>T))</span>
<span id="cb2-6"><a></a></span>
<span id="cb2-7"><a></a>treated</span>
<span id="cb2-8"><a></a><span class="do">## # A tibble: 1 × 2</span></span>
<span id="cb2-9"><a></a><span class="do">##   treated_emp_before treated_emp_after</span></span>
<span id="cb2-10"><a></a><span class="do">##                &lt;dbl&gt;             &lt;dbl&gt;</span></span>
<span id="cb2-11"><a></a><span class="do">## 1               20.4              21.0</span></span>
<span id="cb2-12"><a></a></span>
<span id="cb2-13"><a></a>control <span class="ot">&lt;-</span> card_krueger_data <span class="sc">|&gt;</span></span>
<span id="cb2-14"><a></a>  <span class="fu">filter</span>(state<span class="sc">==</span><span class="dv">0</span>)<span class="sc">|&gt;</span></span>
<span id="cb2-15"><a></a>  <span class="fu">summarize</span>(<span class="at">control_emp_before =</span> <span class="fu">mean</span>(employment[time<span class="sc">==</span><span class="st">'before'</span>], <span class="at">na.rm=</span>T),</span>
<span id="cb2-16"><a></a>            <span class="at">control_emp_after =</span> <span class="fu">mean</span>(employment[time<span class="sc">==</span><span class="st">'after'</span>], <span class="at">na.rm=</span>T))</span>
<span id="cb2-17"><a></a></span>
<span id="cb2-18"><a></a>control</span>
<span id="cb2-19"><a></a><span class="do">## # A tibble: 1 × 2</span></span>
<span id="cb2-20"><a></a><span class="do">##   control_emp_before control_emp_after</span></span>
<span id="cb2-21"><a></a><span class="do">##                &lt;dbl&gt;             &lt;dbl&gt;</span></span>
<span id="cb2-22"><a></a><span class="do">## 1               23.3              21.2</span></span>
<span id="cb2-23"><a></a></span>
<span id="cb2-24"><a></a>tau_did <span class="ot">&lt;-</span> treated<span class="sc">$</span>treated_emp_after <span class="sc">-</span> treated<span class="sc">$</span>treated_emp_before <span class="sc">-</span> (control<span class="sc">$</span>control_emp_after <span class="sc">-</span> control<span class="sc">$</span>control_emp_before)</span>
<span id="cb2-25"><a></a></span>
<span id="cb2-26"><a></a>tau_did</span>
<span id="cb2-27"><a></a><span class="do">## [1] 2.753606</span></span>
<span id="cb2-28"><a></a></span>
<span id="cb2-29"><a></a>pre_treatment_mean <span class="ot">&lt;-</span> card_krueger_data <span class="sc">|&gt;</span> </span>
<span id="cb2-30"><a></a>  <span class="fu">filter</span>(state<span class="sc">==</span><span class="dv">1</span>, time<span class="sc">==</span><span class="st">'before'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-31"><a></a>  <span class="fu">summarize</span>(<span class="at">m =</span> <span class="fu">mean</span>(employment, <span class="at">na.rm=</span>T)) <span class="sc">|&gt;</span></span>
<span id="cb2-32"><a></a>  <span class="fu">pull</span>(m)</span>
<span id="cb2-33"><a></a></span>
<span id="cb2-34"><a></a>tau_did<span class="sc">/</span>pre_treatment_mean</span>
<span id="cb2-35"><a></a><span class="do">## [1] 0.1347204</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-2">
<ul>
<li>Download the Card &amp; Krueger (1994) data</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-3"><a></a></span>
<span id="cb3-4"><a></a><span class="co"># Load data</span></span>
<span id="cb3-5"><a></a>file_url <span class="op">=</span> <span class="st">"https://github.com/mca91/EconometricsWithR/blob/master/data/fastfood.dta?raw=true"</span></span>
<span id="cb3-6"><a></a>card_krueger_data <span class="op">=</span> pd.read_stata(file_url)</span>
<span id="cb3-7"><a></a></span>
<span id="cb3-8"><a></a><span class="co"># Preview data</span></span>
<span id="cb3-9"><a></a><span class="bu">print</span>(card_krueger_data.head())</span>
<span id="cb3-10"><a></a><span class="co">##    sheet  chain  co_owned  state  ...  pfry2  pentree2  nregs2  nregs112</span></span>
<span id="cb3-11"><a></a><span class="co">## 0     46      1         0      0  ...    NaN      0.94     4.0       4.0</span></span>
<span id="cb3-12"><a></a><span class="co">## 1     49      2         0      0  ...   0.89      2.35     4.0       4.0</span></span>
<span id="cb3-13"><a></a><span class="co">## 2    506      2         1      0  ...   0.74      2.33     4.0       3.0</span></span>
<span id="cb3-14"><a></a><span class="co">## 3     56      4         1      0  ...   0.79      0.87     2.0       2.0</span></span>
<span id="cb3-15"><a></a><span class="co">## 4     61      4         1      0  ...   0.84      0.95     2.0       2.0</span></span>
<span id="cb3-16"><a></a><span class="co">## </span></span>
<span id="cb3-17"><a></a><span class="co">## [5 rows x 46 columns]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>Compute <span class="math inline">\(\tau_{DID}\)</span></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a></a><span class="co"># Treatment group before and after</span></span>
<span id="cb4-2"><a></a>treated <span class="op">=</span> card_krueger_data[card_krueger_data[<span class="st">'state'</span>] <span class="op">==</span> <span class="dv">1</span>]</span>
<span id="cb4-3"><a></a>treated_before <span class="op">=</span> treated[treated[<span class="st">'time'</span>] <span class="op">==</span> <span class="st">'before'</span>][<span class="st">'employment'</span>].mean()</span>
<span id="cb4-4"><a></a>treated_after <span class="op">=</span> treated[treated[<span class="st">'time'</span>] <span class="op">==</span> <span class="st">'after'</span>][<span class="st">'employment'</span>].mean()</span>
<span id="cb4-5"><a></a></span>
<span id="cb4-6"><a></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Treated group:"</span>)</span>
<span id="cb4-7"><a></a><span class="co">## </span></span>
<span id="cb4-8"><a></a><span class="co">## Treated group:</span></span>
<span id="cb4-9"><a></a><span class="bu">print</span>(<span class="ss">f"Before: </span><span class="sc">{</span>treated_before<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-10"><a></a><span class="co">## Before: 20.439407348632812</span></span>
<span id="cb4-11"><a></a><span class="bu">print</span>(<span class="ss">f"After: </span><span class="sc">{</span>treated_after<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-12"><a></a><span class="co">## After: 21.027429580688477</span></span>
<span id="cb4-13"><a></a></span>
<span id="cb4-14"><a></a><span class="co"># Control group before and after</span></span>
<span id="cb4-15"><a></a>control <span class="op">=</span> card_krueger_data[card_krueger_data[<span class="st">'state'</span>] <span class="op">==</span> <span class="dv">0</span>]</span>
<span id="cb4-16"><a></a>control_before <span class="op">=</span> control[control[<span class="st">'time'</span>] <span class="op">==</span> <span class="st">'before'</span>][<span class="st">'employment'</span>].mean()</span>
<span id="cb4-17"><a></a>control_after <span class="op">=</span> control[control[<span class="st">'time'</span>] <span class="op">==</span> <span class="st">'after'</span>][<span class="st">'employment'</span>].mean()</span>
<span id="cb4-18"><a></a></span>
<span id="cb4-19"><a></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Control group:"</span>)</span>
<span id="cb4-20"><a></a><span class="co">## </span></span>
<span id="cb4-21"><a></a><span class="co">## Control group:</span></span>
<span id="cb4-22"><a></a><span class="bu">print</span>(<span class="ss">f"Before: </span><span class="sc">{</span>control_before<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-23"><a></a><span class="co">## Before: 23.33116912841797</span></span>
<span id="cb4-24"><a></a><span class="bu">print</span>(<span class="ss">f"After: </span><span class="sc">{</span>control_after<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-25"><a></a><span class="co">## After: 21.165584564208984</span></span>
<span id="cb4-26"><a></a></span>
<span id="cb4-27"><a></a><span class="co"># Calculate difference-in-differences</span></span>
<span id="cb4-28"><a></a>tau_did <span class="op">=</span> (treated_after <span class="op">-</span> treated_before) <span class="op">-</span> (control_after <span class="op">-</span> control_before)</span>
<span id="cb4-29"><a></a></span>
<span id="cb4-30"><a></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Difference-in-differences estimate:"</span>)</span>
<span id="cb4-31"><a></a><span class="co">## </span></span>
<span id="cb4-32"><a></a><span class="co">## Difference-in-differences estimate:</span></span>
<span id="cb4-33"><a></a><span class="bu">print</span>(tau_did)</span>
<span id="cb4-34"><a></a><span class="co">## 2.7536068</span></span>
<span id="cb4-35"><a></a></span>
<span id="cb4-36"><a></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Relative to pre-treatment mean:"</span>)</span>
<span id="cb4-37"><a></a><span class="co">## </span></span>
<span id="cb4-38"><a></a><span class="co">## Relative to pre-treatment mean:</span></span>
<span id="cb4-39"><a></a>tau_did <span class="op">/</span> treated_before</span>
<span id="cb4-40"><a></a><span class="co">## 0.13472047</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-3">
<ul>
<li>Download the Card &amp; Krueger (1994) data</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource stata number-lines code-with-copy"><code class="sourceCode stata"><span id="cb5-1"><a></a>* Load <span class="kw">data</span> from URL</span>
<span id="cb5-2"><a></a>copy <span class="st">"https://github.com/mca91/EconometricsWithR/blob/master/data/fastfood.dta?raw=true"</span> fastfood.dta, <span class="kw">replace</span></span>
<span id="cb5-3"><a></a><span class="kw">use</span> fastfood.dta, <span class="kw">clear</span></span>
<span id="cb5-4"><a></a></span>
<span id="cb5-5"><a></a>* Preview <span class="kw">data</span></span>
<span id="cb5-6"><a></a><span class="ot">list</span> <span class="kw">in</span> 1/5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>Compute <span class="math inline">\(\tau_{DID}\)</span></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a></a><span class="op">*</span> Calculate difference<span class="op">-</span><span class="kw">in</span><span class="op">-</span>differences</span>
<span id="cb6-2"><a></a><span class="bu">sum</span> fte <span class="cf">if</span> state <span class="op">==</span> <span class="dv">1</span> <span class="op">&amp;</span> time <span class="op">==</span> <span class="dv">1</span>  <span class="op">//</span> treated before</span>
<span id="cb6-3"><a></a>local treated_before <span class="op">=</span> r(mean)</span>
<span id="cb6-4"><a></a><span class="bu">sum</span> fte <span class="cf">if</span> state <span class="op">==</span> <span class="dv">1</span> <span class="op">&amp;</span> time <span class="op">==</span> <span class="dv">2</span>  <span class="op">//</span> treated after</span>
<span id="cb6-5"><a></a>local treated_after <span class="op">=</span> r(mean)</span>
<span id="cb6-6"><a></a><span class="bu">sum</span> fte <span class="cf">if</span> state <span class="op">==</span> <span class="dv">0</span> <span class="op">&amp;</span> time <span class="op">==</span> <span class="dv">1</span>  <span class="op">//</span> control before</span>
<span id="cb6-7"><a></a>local control_before <span class="op">=</span> r(mean)</span>
<span id="cb6-8"><a></a><span class="bu">sum</span> fte <span class="cf">if</span> state <span class="op">==</span> <span class="dv">0</span> <span class="op">&amp;</span> time <span class="op">==</span> <span class="dv">2</span>  <span class="op">//</span> control after</span>
<span id="cb6-9"><a></a>local control_after <span class="op">=</span> r(mean)</span>
<span id="cb6-10"><a></a></span>
<span id="cb6-11"><a></a>local did <span class="op">=</span> (`treated_after<span class="st">' - `treated_before'</span>) <span class="op">-</span> (`control_after<span class="st">' - `control_before'</span>)</span>
<span id="cb6-12"><a></a>display <span class="st">"Difference-in-differences estimate: "</span> `did<span class="st">'</span></span>
<span id="cb6-13"><a></a></span>
<span id="cb6-14"><a></a><span class="er">display "Relative to pre-treatment mean:" `did / treated_before'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="visualization" class="slide level2">
<h2>Visualization</h2>

<img data-src="lecture7_files/figure-revealjs/unnamed-chunk-10-1.png" class="quarto-figure quarto-figure-center r-stretch" width="1152"></section>
<section id="deconstructing-the-did-graph" class="slide level2">
<h2>Deconstructing the DiD Graph</h2>
<ul>
<li>The <strong>solid blue line</strong> is the observed trend for the control group.</li>
<li>The <strong>solid green line</strong> is the observed outcome for the treatment group.</li>
<li>The <strong>dotted orange line</strong> is the <em>counterfactual</em> for the treatment group, constructed by assuming its trend would have been parallel to the control group’s trend.</li>
<li>The <strong>DiD effect</strong> is the vertical distance between the actual outcome for the treatment group and its counterfactual outcome in the post-period.</li>
</ul>
</section></section>
<section>
<section id="did-under-potential-outcomes" class="title-slide slide level1 center">
<h1>DiD Under Potential Outcomes</h1>

</section>
<section id="did-under-potential-outcomes-1" class="slide level2">
<h2>DiD Under Potential Outcomes</h2>
<ul>
<li><p>The observed outcome, <span class="math inline">\(Y_{it}\)</span>, is determined by the unit’s group status and the time period.</p></li>
<li><p>For the <strong>treated group</strong> (<span class="math inline">\(D_i=1\)</span>): They are untreated at <span class="math inline">\(t=0\)</span> and treated at <span class="math inline">\(t=1\)</span>.</p>
<ul>
<li><span class="math inline">\(Y_{i0} = Y_{i0}(0)\)</span> for <span class="math inline">\(t=0\)</span> (pre-treatment)</li>
<li><span class="math inline">\(Y_{i1} = Y_{i1}(1)\)</span> for <span class="math inline">\(t=1\)</span> (post-treatment)</li>
</ul></li>
<li><p>For the <strong>control group</strong> (<span class="math inline">\(D_i=0\)</span>): They are never treated.</p>
<ul>
<li><span class="math inline">\(Y_{i0} = Y_{i0}(0)\)</span> for <span class="math inline">\(t=0\)</span></li>
<li><span class="math inline">\(Y_{i1} = Y_{i1}(0)\)</span> for <span class="math inline">\(t=1\)</span></li>
</ul></li>
</ul>
</section>
<section id="example-interpretation" class="slide level2">
<h2>Example Interpretation</h2>
<div title="Example: DiD Under Potential Outcomes">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Example: DiD Under Potential Outcomes</strong></p>
</div>
<div class="callout-content">
<p>Let the treatment <span class="math inline">\(D\)</span> be a job training program. Let the outcome <span class="math inline">\(Y\)</span> be monthly income. Let the treated group <span class="math inline">\(D_i=1\)</span> consist of Alice, and the control group <span class="math inline">\(D_i=0\)</span> consist of Bob.</p>
<ul>
<li>For the treated group:
<ul>
<li>Pre-treatment (<span class="math inline">\(t=0\)</span>): <span class="math inline">\(Y_{i0} = Y_{i0} (0)\)</span></li>
<li>Alice’s observed income before training is her potential income without training.</li>
<li>Post-treatment (<span class="math inline">\(t=1\)</span>): <span class="math inline">\(Y_{i1} = Y_{i1} (1)\)</span></li>
<li>Alice’s observed income after training is her potential income with training.</li>
</ul></li>
<li>For the control group:
<ul>
<li>Pre-treatment (<span class="math inline">\(t=0\)</span>): <span class="math inline">\(Y_{i0} = Y_{i0} (0)\)</span></li>
<li>Bob’s observed income is his potential income without training.</li>
<li>Post-treatment (<span class="math inline">\(t=1\)</span>): <span class="math inline">\(Y_{i1} = Y_{i1} (0)\)</span></li>
<li>Bob’s observed income is his potential income without training, as he remains untreated.</li>
</ul></li>
</ul>
</div>
</div>
</div>
</div>
</section>
<section id="estimand-att" class="slide level2">
<h2>Estimand: ATT</h2>
<ul>
<li><p>Formally, the ATT is the difference between the treated group’s outcome at <span class="math inline">\(t=1\)</span> and what their outcome <em>would have been</em> at <span class="math inline">\(t=1\)</span> if they had not been treated.</p>
<p><span class="math display">\[
  \text{ATT} = E[Y_{i1}(1) | D_i=1] - E[Y_{i1}(0) | D_i=1]
\]</span></p></li>
<li><p>The first term, <span class="math inline">\(E[Y_{i1}(1) | D_i=1]\)</span>, is observed as the average outcome for the treated group in the post-period, <span class="math inline">\(E[Y_{i1} | D_i=1]\)</span>.</p></li>
<li><p>The second term, <span class="math inline">\(E[Y_{i1}(0) | D_i=1]\)</span>, is the <strong>counterfactual</strong>.</p>
<ul>
<li>It is the unobservable average outcome for the treated group had they not received the treatment.</li>
<li>The entire goal of the DiD strategy is to find a way to estimate this term.</li>
</ul></li>
</ul>
</section>
<section id="parallel-trends" class="slide level2">
<h2>Parallel Trends</h2>
<ul>
<li>The DiD estimator is valid under the <strong>parallel trends assumption</strong>.
<ul>
<li>This assumption states that, in the absence of treatment, the average outcome for the treated group would have changed over time by the same amount as the average outcome for the control group.</li>
<li>Mathematically, this is expressed in terms of the potential outcome under no-treatment, <span class="math inline">\(Y_{it}(0)\)</span>:</li>
</ul></li>
</ul>
<div title="Definition: Parallel Trends">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Definition: Parallel Trends</strong></p>
</div>
<div class="callout-content">
<p><span id="eq-pt"><span class="math display">\[E[Y_{i1}(0) - Y_{i0}(0) | D_i=1] = E[Y_{i1}(0) - Y_{i0}(0) | D_i=0] \qquad(1)\]</span></span></p>
</div>
</div>
</div>
</div>
<ul>
<li>The left side is the counterfactual change for the treated group.</li>
<li>The right side is the observed change for the control group, since for them <span class="math inline">\(Y_{it} = Y_{it}(0)\)</span>.
<ul>
<li>This assumption allows us to use the control group to identify the counterfactual trend for the treated group.</li>
</ul></li>
</ul>
</section>
<section id="derivation-of-the-did-estimator" class="slide level2">
<h2>Derivation of the DiD Estimator</h2>
<ul>
<li>We rearrange the parallel trends assumption from <a href="#/parallel-trends" class="quarto-xref">Equation&nbsp;1</a> to solve for our unobserved counterfactual:</li>
</ul>
<p><span class="math display">\[\begin{align}
\label{eq:cf}
E[Y_{i1}(0) | D_i=1] = &amp;\underbrace{E[Y_{i0}(0) | D_i=1]}_{\text{Treated pre-treatment}} + \\ &amp;\underbrace{\left( E[Y_{i1}(0) | D_i=0] - E[Y_{i0}(0) | D_i=0] \right)}_{\text{Change in control group}}
\end{align}\]</span></p>
<ul>
<li>This equation shows how we construct the counterfactual: we take the treated group’s initial level and add the change experienced by the control group.</li>
</ul>
</section>
<section id="derivation-of-the-did-estimator-1" class="slide level2">
<h2>Derivation of the DiD Estimator</h2>
<ul>
<li>Substitute this expression for the counterfactual back into the definition of ATT:</li>
</ul>
<p><span class="math display">\[
\begin{align}
\text{ATT} &amp;= E[Y_{i1}(1) | D_i=1] - E[Y_{i1}(0) | D_i=1] \\
    &amp;= E[Y_{i1}(1) | D_i=1] - \\
    &amp;\quad \underbrace{\left( E[Y_{i0}(0) | D_i=1] + E[Y_{i1}(0) | D_i=0] - E[Y_{i0}(0) | D_i=0] \right)}_{\text{Expression for counterfactual}}
\end{align}
\]</span></p>
</section>
<section id="replacing-potential-outcomes-with-observables" class="slide level2">
<h2>Replacing Potential Outcomes with Observables</h2>
<ul>
<li><p>Finally, we replace the potential outcomes with their observable counterparts to obtain <span class="math inline">\(\widehat{\tau_{\text{DID}}}\)</span>:</p>
<p><span class="math display">\[
  \begin{align}
  \text{ATT} &amp;= \color{red}{E[Y_{i1}(1) | D_i=1]} - \\
  &amp;\quad \biggl( \color{blue}{E[Y_{i0}(0) | D_i=1]} + \color{orange}{E[Y_{i1}(0) | D_i=0]} - \color{green}{E[Y_{i0}(0) | D_i=0]} \biggr) \\
  &amp;= \color{red}{E[Y_{i1} | D_i = 1 ]} - \\
  &amp;\quad \biggl(  \color{blue}{E[Y_{i0} | D_i = 1]} + \color{orange}{E[Y_{i1} | D_i = 0]} - \color{green}{E[Y_{i0} | D_i = 0]}\biggr) \\
  &amp;= \widehat{\tau_{DID}}
  \end{align}
\]</span></p></li>
<li><p>This is the famous “difference-in-differences” formula. It identifies the ATT under the crucial assumption of parallel trends.</p></li>
</ul>
</section></section>
<section>
<section id="did-in-regression" class="title-slide slide level1 center">
<h1>DiD in Regression</h1>

</section>
<section id="did-using-a-regression-framework" class="slide level2">
<h2>DiD using a Regression Framework</h2>
<ul>
<li>We can estimate the exact same 2x2 DiD using a simple OLS regression. This is more powerful and flexible.</li>
</ul>
<div title="Definition: DiD in a Regression Framework">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Definition: DiD in a Regression Framework</strong></p>
</div>
<div class="callout-content">
<p><span class="math inline">\(Y_{it} = \beta_0 + \beta_1 Treat_i + \beta_2 Post_t + \beta_3(Treat_i × Post_t) + \epsilon_{it}\)</span></p>
<ul>
<li><span class="math inline">\(Y_{it}\)</span>: Outcome for unit <em>i</em> at time <em>t</em>.</li>
<li><span class="math inline">\(Treat_i\)</span>: A dummy variable = 1 if unit <em>i</em> is in the treatment group, 0 otherwise.</li>
<li><span class="math inline">\(Post_t\)</span>: A dummy variable = 1 if the period is “Post”, 0 otherwise.</li>
<li><span class="math inline">\(Treat_i \times Post_t\)</span>: An interaction term.</li>
</ul>
</div>
</div>
</div>
</div>
</section>
<section id="interpretation-of-coefficients-12" class="slide level2">
<h2>Interpretation of Coefficients (1/2)</h2>
<ul>
<li>Let’s break down what each <span class="math inline">\(\beta\)</span> represents:</li>
</ul>
<p><span class="math inline">\(Y_{it} = \beta_0 + \beta_1 Treat_i + \beta_2 Post_t + \beta_3(Treat_i \times Post_t) + \epsilon_{it}\)</span></p>
<ul>
<li><strong><span class="math inline">\(\beta_0\)</span> (Intercept):</strong> The average outcome for the <strong>Control Group</strong> (<code>Treat=0</code>) in the <strong>Pre-Period</strong> (<code>Post=0</code>).
<ul>
<li><span class="math inline">\(E[Y | Treat=0, Post=0] = \beta_0\)</span></li>
</ul></li>
<li><strong><span class="math inline">\(\beta_1\)</span>:</strong> The average <em>pre-existing difference</em> between the treatment and control groups in the pre-period. <strong>This is the selection bias.</strong>
<ul>
<li><span class="math inline">\(E[Y | Treat=1, Post=0] = \beta_0 + \beta_1\)</span></li>
<li>So, <span class="math inline">\(\beta_1 = E[Y | Treat=1, Post=0] - E[Y | Treat=0, Post=0]\)</span></li>
</ul></li>
</ul>
</section>
<section id="interpretation-of-coefficients-22" class="slide level2">
<h2>Interpretation of Coefficients (2/2)</h2>
<p><span class="math display">\[
    Y_{it} = \beta_0 + \beta_1Treat_i + \beta_2Post_t + \beta_3(Treat_i \times Post_t) + \epsilon_{it}
  \]</span></p>
<ul>
<li><strong><span class="math inline">\(\beta_2\)</span>:</strong> The average change in the outcome for the <strong>Control Group</strong> from the pre- to the post-period. <strong>This is the secular trend.</strong>
<ul>
<li><span class="math inline">\(E[Y | Treat=0, Post=1] = \beta_0 + \beta_2\)</span></li>
<li>So, <span class="math inline">\(\beta_2 = E[Y | Treat=0, Post=1] - E[Y | Treat=0, Post=0]\)</span></li>
</ul></li>
<li><strong><span class="math inline">\(\beta_3\)</span>:</strong> <strong>This is the DiD estimator!</strong> It’s the additional change in the outcome for the Treatment Group, above and beyond the secular trend.
<ul>
<li>It is the causal effect of interest.</li>
<li><span class="math inline">\(\beta_3 = (E[Y|T=1,P=1] - E[Y|T=1,P=0]) - (E[Y|T=0,P=1] - E[Y|T=0,P=0])\)</span></li>
<li>Hence <span class="math inline">\(\beta_3\)</span> is <span class="math inline">\(\tau_{DID}\)</span></li>
</ul></li>
</ul>
</section>
<section id="example-did-in-a-regression-framework" class="slide level2">
<h2>Example: DiD in a Regression Framework</h2>
<div title="Example: Card and Krueger (1994)">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Example: Card and Krueger (1994)</strong></p>
</div>
<div class="callout-content">
<p>The Card and Krueger (1994) estimate can also be recovered using the specification we have seen above. Recall that <span class="math inline">\(\tau_{DID}=2.75\)</span>.</p>
<div class="panel-tabset hey">
<ul id="tabset-2" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-2-1">R</a></li><li><a href="#tabset-2-2">Python</a></li><li><a href="#tabset-2-3">Stata</a></li></ul>
<div class="tab-content hey">
<div id="tabset-2-1">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(employment <span class="sc">~</span> state<span class="sc">*</span>time, <span class="at">data =</span> card_krueger_data)</span>
<span id="cb7-2"><a></a><span class="fu">summary</span>(model)</span>
<span id="cb7-3"><a></a><span class="do">## </span></span>
<span id="cb7-4"><a></a><span class="do">## Call:</span></span>
<span id="cb7-5"><a></a><span class="do">## lm(formula = employment ~ state * time, data = card_krueger_data)</span></span>
<span id="cb7-6"><a></a><span class="do">## </span></span>
<span id="cb7-7"><a></a><span class="do">## Residuals:</span></span>
<span id="cb7-8"><a></a><span class="do">##     Min      1Q  Median      3Q     Max </span></span>
<span id="cb7-9"><a></a><span class="do">## -21.166  -6.439  -1.027   4.473  64.561 </span></span>
<span id="cb7-10"><a></a><span class="do">## </span></span>
<span id="cb7-11"><a></a><span class="do">## Coefficients:</span></span>
<span id="cb7-12"><a></a><span class="do">##                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb7-13"><a></a><span class="do">## (Intercept)       23.331      1.072  21.767   &lt;2e-16 ***</span></span>
<span id="cb7-14"><a></a><span class="do">## state             -2.892      1.194  -2.423   0.0156 *  </span></span>
<span id="cb7-15"><a></a><span class="do">## timeafter         -2.166      1.516  -1.429   0.1535    </span></span>
<span id="cb7-16"><a></a><span class="do">## state:timeafter    2.754      1.688   1.631   0.1033    </span></span>
<span id="cb7-17"><a></a><span class="do">## ---</span></span>
<span id="cb7-18"><a></a><span class="do">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span id="cb7-19"><a></a><span class="do">## </span></span>
<span id="cb7-20"><a></a><span class="do">## Residual standard error: 9.406 on 790 degrees of freedom</span></span>
<span id="cb7-21"><a></a><span class="do">##   (26 observations deleted due to missingness)</span></span>
<span id="cb7-22"><a></a><span class="do">## Multiple R-squared:  0.007401,   Adjusted R-squared:  0.003632 </span></span>
<span id="cb7-23"><a></a><span class="do">## F-statistic: 1.964 on 3 and 790 DF,  p-value: 0.118</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-2">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a></a><span class="im">import</span> pyfixest <span class="im">as</span> pf</span>
<span id="cb8-2"><a></a>model <span class="op">=</span> pf.feols(<span class="st">"employment ~ time + state + time*state"</span>, data<span class="op">=</span>r.card_krueger_data)</span>
<span id="cb8-3"><a></a>model.summary()</span>
<span id="cb8-4"><a></a><span class="co">## </span><span class="al">###</span></span>
<span id="cb8-5"><a></a><span class="co">## </span></span>
<span id="cb8-6"><a></a><span class="co">## Estimation:  OLS</span></span>
<span id="cb8-7"><a></a><span class="co">## Dep. var.: employment, Fixed effects: 0</span></span>
<span id="cb8-8"><a></a><span class="co">## Inference:  iid</span></span>
<span id="cb8-9"><a></a><span class="co">## Observations:  794</span></span>
<span id="cb8-10"><a></a><span class="co">## </span></span>
<span id="cb8-11"><a></a><span class="co">## | Coefficient         |   Estimate |   Std. Error |   t value |   Pr(&gt;|t|) |   2.5% |   97.5% |</span></span>
<span id="cb8-12"><a></a><span class="co">## |:--------------------|-----------:|-------------:|----------:|-----------:|-------:|--------:|</span></span>
<span id="cb8-13"><a></a><span class="co">## | Intercept           |     23.331 |        1.072 |    21.767 |      0.000 | 21.227 |  25.435 |</span></span>
<span id="cb8-14"><a></a><span class="co">## | time[T.after]       |     -2.166 |        1.516 |    -1.429 |      0.154 | -5.141 |   0.810 |</span></span>
<span id="cb8-15"><a></a><span class="co">## | state               |     -2.892 |        1.194 |    -2.423 |      0.016 | -5.235 |  -0.549 |</span></span>
<span id="cb8-16"><a></a><span class="co">## | time[T.after]:state |      2.754 |        1.688 |     1.631 |      0.103 | -0.561 |   6.068 |</span></span>
<span id="cb8-17"><a></a><span class="co">## ---</span></span>
<span id="cb8-18"><a></a><span class="co">## RMSE: 9.382 R2: 0.007</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-2-3">
<p>Hey</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="advantages-of-the-regression-framework" class="slide level2">
<h2>Advantages of the Regression Framework</h2>
<ul>
<li>Why bother with regression instead of just calculating the four means?</li>
</ul>
<ol type="1">
<li><p><strong>Standard Errors:</strong> Regression automatically provides standard errors, t-statistics, and p-values for your DiD estimate (<span class="math inline">\(\beta_3\)</span>), allowing for statistical inference.</p></li>
<li><p><strong>Adding Covariates:</strong> It is easy to add control variables to the model to increase precision and make the parallel trends assumption more plausible.</p></li>
<li><p><strong>Flexibility:</strong> The framework is easily extended to more complex scenarios (more groups, more time periods, etc.).</p></li>
</ol>
</section>
<section id="adding-covariates-to-the-did-model" class="slide level2">
<h2>Adding Covariates to the DiD Model</h2>
<ul>
<li><p>We can add a vector of control variables, <span class="math inline">\(X\)</span>, to the regression.</p>
<p><span class="math display">\[
  Y_{it} = \beta_0 + \beta_1Treat_i + \beta_2Post_t + \beta_3(Treat_i \times Post_t) + \gamma'X_{it} + \epsilon_{it}
\]</span></p></li>
<li><p>The purpose is to control for observable characteristics that might differ between the groups and affect trends in the outcome.</p></li>
<li><p>This helps strengthen the parallel trends assumption. It becomes “parallel trends <em>conditional on X</em>”.</p></li>
<li><p><em>Example:</em> When studying a state-level policy, you might control for state GDP, population size, etc.</p></li>
</ul>
</section>
<section id="testing-the-parallel-trends-assumption" class="slide level2">
<h2>Testing the Parallel Trends Assumption</h2>
<ul>
<li><p>We can’t prove the assumption, but we can build evidence for it. This requires data from <strong>multiple pre-treatment periods</strong>.</p></li>
<li><p><strong>Method 1: Visual Inspection (Most Common)</strong></p>
<ul>
<li>Plot the average outcomes for the treatment and control groups over time.</li>
<li>Visually check if their trends were parallel in the periods <em>before</em> the treatment was introduced.</li>
</ul></li>
</ul>

<img data-src="lecture7_files/figure-revealjs/unnamed-chunk-13-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="statistical-tests-for-parallel-trends" class="slide level2">
<h2>Statistical Tests for Parallel Trends</h2>
<ul>
<li>If you have multiple pre-treatment periods, you can run a “placebo” test.
<ul>
<li>The idea is to run a DiD analysis using only pre-treatment data. For instance, define a fake “treatment” in period t-2 and use t-3 as the “pre” period.</li>
</ul></li>
<li><strong>In a regression:</strong> interact the treatment group dummy with time-period dummies for <em>each pre-treatment period</em>:</li>
</ul>
<div title="DiD Placebo Test">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>DiD Placebo Test</strong></p>
</div>
<div class="callout-content">
<p><span class="math display">\[
\begin{align}
    Y_{it} = &amp;\beta_0 + \beta_1 \text{Treat}_i + \beta_2 \text{Post}_t + \dots + \\ &amp;\delta_{-2} (\text{Treat} \times \text{PrePeriod}_{-2}) + \delta_{-1} (\text{Treat} \times \text{PrePeriod}_{-1}) + \\
    &amp;\beta_3(\text{Treat}_i \times \text{Post}_t) + \epsilon_{it}
\end{align}
\]</span></p>
<p><strong>Result:</strong> The coefficients <span class="math inline">\(\delta_{-2}\)</span> and <span class="math inline">\(\delta_{-1}\)</span> should be small and statistically insignificant (not different from zero). This shows there was no pre-existing differential trend.</p>
</div>
</div>
</div>
</div>
</section>
<section id="extension-multiple-periods-staggered-adoption" class="slide level2">
<h2>Extension: Multiple Periods &amp; Staggered Adoption</h2>
<ul>
<li><p>The real world is often messier than 2x2.</p></li>
<li><p>Often times, treatments have <strong>staggered adoption:</strong></p>
<ul>
<li>Different units receive the treatment at different times.</li>
<li>For example, State A adopts a policy in 2010, State B in 2012, State C never does.</li>
</ul></li>
<li><p>The simple 2x2 Treat <span class="math inline">\(\times\)</span> Post model is no longer sufficient and can be biased.</p></li>
<li><p>Modern methods (e.g., Callaway &amp; Sant’Anna, Sun &amp; Abraham) address these issues by using better defined control groups for each treated unit.</p></li>
</ul>
</section>
<section id="staggered-adoption" class="slide level2">
<h2>Staggered Adoption</h2>
<ul>
<li><p>Many modern DiD settings involve , where different units get treated at different times.</p></li>
<li><p>The standard tool for this has been the two-way fixed effects (TWFE) regression:</p>
<p><span class="math display">\[\begin{equation*}
    Y_{it} = \alpha_i + \lambda_t + \beta^{TWFE} \cdot D_{it} + \epsilon_{it}
\end{equation*}\]</span> where <span class="math inline">\(D_{it}=1\)</span> if unit <span class="math inline">\(i\)</span> is treated at time <span class="math inline">\(t\)</span>.</p></li>
<li><p>Recent research (Goodman-Bacon, 2021; de Chaisemartin &amp; D’Haultfœuille, 2020; 2022) shows that <span class="math inline">\(\hat{\beta}^{TWFE}\)</span> is a weighted average of all possible 2x2 DiD estimators.</p></li>
<li><p>Some of these comparisons are “bad”: they use already-treated units as controls for later-treated units.</p></li>
</ul>
</section>
<section id="why-are-bad-comparisons-a-problem" class="slide level2">
<h2>Why Are Bad Comparisons A Problem?</h2>
<div title="Example: Bad Comparison">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Example: Bad Comparison</strong></p>
</div>
<div class="callout-content">
<p>Imagine Cohort 2010 gets treated in 2010 and Cohort 2012 gets treated in 2012. To estimate the effect on Cohort 2012 in the year 2012, TWFE implicitly uses the observations from Cohort 2010 as part of the “control” group. But Cohort 2010 has already been treated for two years!</p>
</div>
</div>
</div>
</div>
<ul>
<li><p>This is only valid if treatment effects are constant across cohorts and time. If effects are heterogeneous or dynamic (e.g., they grow over time), this comparison is contaminated.</p></li>
<li><p>The resulting <span class="math inline">\(\hat{\beta}^{TWFE}\)</span> can be a meaningless average, sometimes with negative weights, and may not represent any true ATT.</p></li>
</ul>
</section>
<section id="sun-and-abraham-2021-solution" class="slide level2">
<h2>Sun and Abraham (2021) Solution</h2>
<ul>
<li>The core idea is to avoid aggregation and bad comparisons.</li>
</ul>
<div title="Sun and Abraham (2021) Procedure">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Sun and Abraham (2021) Procedure</strong></p>
</div>
<div class="callout-content">
<p>Step 1: Define cohorts</p>
<p>A cohort, <span class="math inline">\(G=g\)</span>, is the group of all units that are first treated at the same time period <span class="math inline">\(g\)</span>.</p>
<p>Let <span class="math inline">\(G=\infty\)</span> (or <span class="math inline">\(G=C\)</span>) be the group.</p>
<p>Step 2: Estimate Cohort-Specific ATTs</p>
<p>Instead of one <span class="math inline">\(\beta\)</span>, estimate a separate effect for <em>each cohort</em> <span class="math inline">\(g\)</span> at <em>each time period</em> <span class="math inline">\(\ell\)</span>.</p>
<p>Use only clean controls: units that are not yet treated. The never-treated group (<span class="math inline">\(G=C\)</span>) is the cleanest control.</p>
</div>
</div>
</div>
</div>
</section>
<section id="identification-of-cohort-specific-att" class="slide level2">
<h2>Identification of Cohort-Specific ATT</h2>
<ul>
<li><p>The estimand of interest is the ATT for cohort <span class="math inline">\(g\)</span> at calendar time <span class="math inline">\(\ell\)</span> (where <span class="math inline">\(\ell \ge g\)</span>). We denote this <span class="math inline">\(\text{ATT}(g, \ell)\)</span>.</p></li>
<li><p>For each pair <span class="math inline">\((g, \ell)\)</span>, <span class="math inline">\(\text{ATT}(g, \ell)\)</span> is identified by a simple 2x2 DiD comparing cohort <span class="math inline">\(g\)</span> to the clean control group (<span class="math inline">\(C\)</span>) between the pre-treatment period (<span class="math inline">\(g-1\)</span>) and period <span class="math inline">\(\ell\)</span>:</p></li>
</ul>
<p><span class="math display">\[\begin{align*}
    \widehat{\text{ATT}}(g, \ell) = \Big( &amp;E[Y_\ell | G=g] - E[Y_{g-1} | G=g] \Big) \\
    - \Big( &amp;E[Y_\ell | G=C] - E[Y_{g-1} | G=C] \Big)
\end{align*}\]</span></p>
<ul>
<li>Identification assumption in this case is a cohort-specific parallel trends assumption.
<ul>
<li>In the absence of treatment, the outcome for cohort <span class="math inline">\(g\)</span> would have evolved in parallel to the outcome for the never-treated (or not-yet-treated) group.</li>
</ul></li>
</ul>
</section>
<section id="bias-variance-trade-off" class="slide level2">
<h2>Bias-variance Trade-off</h2>
<ul>
<li><p>The Sun and Abraham (2021) framework is flexible. You can choose your control group to manage the bias-variance trade-off:</p></li>
<li><p>Option A: Never-Treated Controls:</p>
<ul>
<li>This is the cleanest option, requiring the weakest parallel trends assumption (only vs.&nbsp;never-treated). It is preferred if the group is large enough.</li>
</ul></li>
<li><p>Option B: Not-Yet-Treated Controls.</p>
<ul>
<li>The estimator can use all currently untreated units as a time-varying control group.</li>
<li>This substantially increases statistical power and reduces variance. The cost is a slightly stronger (but still plausible) parallel trends assumption against these not-yet-treated units.</li>
</ul></li>
</ul>
</section>
<section id="visualizing-staggered-did-event-study-plots" class="slide level2">
<h2>Visualizing Staggered DiD: Event Study Plots</h2>
<ul>
<li>We have seen this already in Lecture 4
<ul>
<li>These plots are standard for visualizing results from models with multiple periods.</li>
</ul></li>
<li><strong>X-axis:</strong> Time relative to the treatment event (e.g., -3, -2, -1, 0, +1, +2 years).</li>
<li><strong>Y-axis:</strong> The estimated DiD coefficient for that relative time period.</li>
<li><strong>Interpretation:</strong>
<ul>
<li>Coefficients for <strong>pre-periods</strong> (<span class="math inline">\(t &lt; 0\)</span>) should be near zero (validates parallel trends).</li>
<li>Coefficients for <strong>post-periods</strong> (<span class="math inline">\(t \geq 0\)</span>) show the dynamic causal effect of the policy over time.</li>
</ul></li>
</ul>
</section>
<section id="visualization-of-sun-and-abraham-2021-approach" class="slide level2">
<h2>Visualization of Sun and Abraham (2021) approach</h2>
<ul>
<li>This is the dataset used in the study by Sun and Abraham (2021)</li>
</ul>
<div class="panel-tabset hey">
<ul id="tabset-3" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-3-1">R</a></li><li><a href="#tabset-3-2">Python</a></li><li><a href="#tabset-3-3">Stata</a></li></ul>
<div class="tab-content hey">
<div id="tabset-3-1">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a></a><span class="fu">library</span>(fixest)</span>
<span id="cb9-2"><a></a><span class="fu">data</span>(base_stagg)</span>
<span id="cb9-3"><a></a><span class="co"># Note that in this dataset, year_treated == 10000 for never treated firms </span></span>
<span id="cb9-4"><a></a><span class="co"># and time_to_treatment == -1000</span></span>
<span id="cb9-5"><a></a>model <span class="ot">&lt;-</span> <span class="fu">feols</span>(y <span class="sc">~</span> <span class="fu">sunab</span>(year_treated, year) <span class="sc">|</span> id <span class="sc">+</span> year, <span class="at">data =</span> base_stagg)</span>
<span id="cb9-6"><a></a><span class="co">#summary(model)</span></span>
<span id="cb9-7"><a></a><span class="fu">iplot</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-2">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a></a><span class="im">import</span> pyfixest <span class="im">as</span> pf</span>
<span id="cb10-2"><a></a>base_stagg <span class="op">=</span> r.base_stagg</span>
<span id="cb10-3"><a></a></span>
<span id="cb10-4"><a></a>fit_twfe_saturated <span class="op">=</span> pf.event_study(</span>
<span id="cb10-5"><a></a>    base_stagg,</span>
<span id="cb10-6"><a></a>    yname<span class="op">=</span><span class="st">"y"</span>,</span>
<span id="cb10-7"><a></a>    idname<span class="op">=</span><span class="st">"id"</span>,</span>
<span id="cb10-8"><a></a>    tname<span class="op">=</span><span class="st">"year"</span>,</span>
<span id="cb10-9"><a></a>    gname<span class="op">=</span><span class="st">"year_treated"</span>,</span>
<span id="cb10-10"><a></a>    estimator<span class="op">=</span><span class="st">"saturated"</span>,</span>
<span id="cb10-11"><a></a>)</span>
<span id="cb10-12"><a></a></span>
<span id="cb10-13"><a></a>fit_twfe_saturated.aggregate()</span>
<span id="cb10-14"><a></a>fit_twfe_saturated.iplot_aggregate()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-3">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource stata number-lines code-with-copy"><code class="sourceCode stata"><span id="cb11-1"><a></a>* Estimate the Sun and Abraham (2021) estimator <span class="kw">in</span> our example:</span>
<span id="cb11-2"><a></a>eventstudyinteract <span class="fu">y</span> id <span class="fu">year</span> year_treated, <span class="kw">fe</span>(id <span class="fu">year</span>) cohort(year_treated) control_cohort(10000) event_time(time_to_treatment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>

<img data-src="lecture7_files/figure-revealjs/unnamed-chunk-17-1.png" class="quarto-figure quarto-figure-center r-stretch" width="672"></section></section>
<section>
<section id="potential-pitfalls" class="title-slide slide level1 center">
<h1>Potential Pitfalls</h1>

</section>
<section id="potential-pitfalls-13-ashenfelters-dip" class="slide level2">
<h2>Potential Pitfalls (1/3): Ashenfelter’s Dip</h2>
<ul>
<li>A famous issue where the parallel trends assumption is violated in a specific way.</li>
<li>The Aschenfelter’s dip is when there is a notable drop in the outcome for the treatment group <em>just before</em> treatment.</li>
</ul>
<div title="Example: Aschenfelter's Dip">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Example: Aschenfelter’s Dip</strong></p>
</div>
<div class="callout-content">
<p>Individuals’ earnings often drop right before they enter a job training program (e.g., due to job loss).</p>
<p>This makes it look like the program had a huge effect, but it’s really just a recovery to a normal level.</p>
</div>
</div>
</div>
</div>
</section>
<section id="potential-pitfalls-23-policy-anticipation-spillovers" class="slide level2">
<h2>Potential Pitfalls (2/3): Policy Anticipation &amp; Spillovers</h2>
<ul>
<li><strong>Anticipation Effects:</strong> If people know a policy is coming, they may change their behavior <em>before</em> it’s officially implemented. This contaminates the “pre” period and violates parallel trends.
<ul>
<li><em>Example:</em> A firm hires fewer people in anticipation of a minimum wage hike.</li>
</ul></li>
<li><strong>Spillover Effects:</strong> The treatment “spills over” and affects the control group.
<ul>
<li><em>Example:</em> A job fair in one city (treatment) draws workers from a neighboring city (control), affecting the control city’s labor market. Your control group is no longer a valid counterfactual.</li>
</ul></li>
</ul>
</section>
<section id="potential-pitfalls-33-other-limitations" class="slide level2">
<h2>Potential Pitfalls (3/3): Other Limitations</h2>
<ul>
<li><strong>Functional Form:</strong> The basic DiD model assumes the treatment effect is a constant, additive shift.</li>
<li><strong>Data Requirements:</strong> Requires panel data (tracking the same units over time) or repeated cross-sectional data.</li>
<li><strong>Bad Control Group:</strong> The entire method relies on finding a credible control group that satisfies the parallel trends assumption. This is often the hardest part.</li>
</ul>
</section></section>
<section>
<section id="summary" class="title-slide slide level1 center">
<h1>Summary</h1>

</section>
<section id="what-did-we-do-today" class="slide level2">
<h2>What did we do today?</h2>
<ul>
<li><strong>Potential Outcomes</strong>:
<ul>
<li>We have seen an introduction to potential outcomes notation. Potential outcomes define outcomes under the treatment and under the control at the individual level.</li>
</ul></li>
<li><strong>The ATE and the ATT</strong>:
<ul>
<li>We have seen two estimands – things we would like to estimate – of interest: the ATT and the ATE. We have discovered assumptions leading to identification of one of those in a cross-sectional context</li>
</ul></li>
<li><strong>Difference-in-difference</strong>:
<ul>
<li>We switched to a two-period setting, which offers a more credible assumption of identifying the ATT: <em>parallel trends</em>.</li>
<li>DiD provides a powerful and intuitive way to estimate causal effects by controlling for time-invariant unobserved differences (selection bias).</li>
</ul></li>
</ul>
</section>
<section id="what-did-we-do-cont." class="slide level2">
<h2>What did we do? (Cont.)</h2>
<ul>
<li><strong>DiD in Regression</strong>:
<ul>
<li>We then saw that the DID estimator can be implemented in a regression framework. A regression framework is useful for S.E.s and inclusion of covariates.</li>
</ul></li>
<li><strong>Testing parallel trends</strong>:
<ul>
<li>In DiD, this assumption is everything. You must convince yourself and your audience that it is plausible.</li>
</ul></li>
<li><strong>Multi-period and staggered adoption</strong>:
<ul>
<li>We have seen extensions of the DiD framework to a multi-period design closely resembling an event study, and we have focused on getting rid of “bad comparisons” in a staggered adoption setting.</li>
</ul></li>
</ul>
</section></section>
<section id="the-end" class="title-slide slide level1 center">
<h1>The End</h1>

<div class="quarto-auto-generated-content">
<p><img src="logo.svg" class="slide-logo"></p>
<div class="footer footer-default">
<p>Empirical Economics: Lecture 7 - Potential Outcomes and DiD</p>
</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":false},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>