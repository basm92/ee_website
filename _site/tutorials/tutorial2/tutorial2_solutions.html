<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.54">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Solutions Tutorial 2 – Empirical Economics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../style.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Empirical Economics</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../lectureslides.html"> 
<span class="menu-text">Lecture Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorialslides.html"> 
<span class="menu-text">Tutorial Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorialanswers.html"> 
<span class="menu-text">Tutorial Answers</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../mockexams.html"> 
<span class="menu-text">Mock Exam</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-nature-of-statistics-and-parameters" id="toc-the-nature-of-statistics-and-parameters" class="nav-link active" data-scroll-target="#the-nature-of-statistics-and-parameters">The Nature of Statistics and Parameters</a></li>
  <li><a href="#constructing-an-exact-sampling-distribution" id="toc-constructing-an-exact-sampling-distribution" class="nav-link" data-scroll-target="#constructing-an-exact-sampling-distribution">Constructing an Exact Sampling Distribution</a></li>
  <li><a href="#sec-simulation" id="toc-sec-simulation" class="nav-link" data-scroll-target="#sec-simulation">Simulating a Sampling Distribution</a></li>
  <li><a href="#applying-the-clt-conceptually" id="toc-applying-the-clt-conceptually" class="nav-link" data-scroll-target="#applying-the-clt-conceptually">Applying the CLT Conceptually</a></li>
  <li><a href="#verifying-the-clt-in-pythonrstata" id="toc-verifying-the-clt-in-pythonrstata" class="nav-link" data-scroll-target="#verifying-the-clt-in-pythonrstata">Verifying the CLT in Python/R/Stata</a></li>
  <li><a href="#formulating-hypotheses" id="toc-formulating-hypotheses" class="nav-link" data-scroll-target="#formulating-hypotheses">Formulating Hypotheses</a></li>
  <li><a href="#interpretation-and-calculation" id="toc-interpretation-and-calculation" class="nav-link" data-scroll-target="#interpretation-and-calculation">Interpretation and Calculation</a></li>
  <li><a href="#performing-a-hypothesis-test" id="toc-performing-a-hypothesis-test" class="nav-link" data-scroll-target="#performing-a-hypothesis-test">Performing a Hypothesis Test</a></li>
  <li><a href="#correct-interpretation" id="toc-correct-interpretation" class="nav-link" data-scroll-target="#correct-interpretation">Correct Interpretation</a></li>
  <li><a href="#factors-affecting-interval-width" id="toc-factors-affecting-interval-width" class="nav-link" data-scroll-target="#factors-affecting-interval-width">Factors Affecting Interval Width</a></li>
  <li><a href="#constructing-a-confidence-interval" id="toc-constructing-a-confidence-interval" class="nav-link" data-scroll-target="#constructing-a-confidence-interval">Constructing a Confidence Interval</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="tutorial2_solutions.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Solutions Tutorial 2</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="the-nature-of-statistics-and-parameters" class="level2">
<h2 class="anchored" data-anchor-id="the-nature-of-statistics-and-parameters">The Nature of Statistics and Parameters</h2>
<p>A <strong>parameter</strong> is a numerical value that describes a characteristic of an entire <strong>population</strong>. A <strong>statistic</strong> is a numerical value that describes a characteristic of a <strong>sample</strong>. The reason a parameter is considered a fixed value and a statistic is a random variable lies in how they are derived.</p>
<ul>
<li><p><strong>Parameter (Fixed)</strong>: A parameter is a single, true value. If we could measure the entire population, we would calculate this one value, and it would not change. It’s often unknown in practice (because measuring an entire population is impractical), but it is conceptually a fixed constant.</p></li>
<li><p><strong>Statistic (Random Variable)</strong>: A statistic is calculated from a subset of the population (a sample). The value of the statistic depends entirely on which specific individuals end up in that random sample. If you were to draw a different random sample, you would get different individuals and thus a different calculated value for the statistic. This variability from sample to sample is what makes a statistic a <strong>random variable</strong>.</p></li>
</ul>
<p>Illustration with Average Height:</p>
<ul>
<li><p><strong>Parameter</strong>: The average height of <strong>all</strong> citizens in a country. There is only one such value. If we could line up every single citizen and measure their height, the average we compute would be the true population mean, <span class="math inline">\(\mu\)</span>. This number is fixed.</p></li>
<li><p><strong>Statistic</strong>: The average height of a randomly selected <strong>sample of 1,000 citizens</strong>.</p>
<ul>
<li>Imagine we take our first sample of 1,000 people and calculate their average height, <span class="math inline">\(\bar{x}_1 = 175.4\)</span> cm.</li>
<li>Now, we discard that sample and draw a <em>new</em>, different random sample of 1,000 people. Maybe this sample, by chance, includes slightly taller people. We calculate their average height and get <span class="math inline">\(\bar{x}_2 = 176.1\)</span> cm.</li>
<li>If we repeat this process again, we might get <span class="math inline">\(\bar{x}_3 = 175.1\)</span> cm.</li>
</ul></li>
</ul>
<p>The sample mean, <span class="math inline">\(\bar{x}\)</span>, is not fixed. Its value changes depending on the random sample drawn. Therefore, it is a random variable.</p>
</section>
<section id="constructing-an-exact-sampling-distribution" class="level2">
<h2 class="anchored" data-anchor-id="constructing-an-exact-sampling-distribution">Constructing an Exact Sampling Distribution</h2>
<p>Given the population <code>[10, 20, 30, 40, 50]</code>.</p>
<ol type="a">
<li><p>Calculate the true population mean, <span class="math inline">\(\mu\)</span>. The population mean is the average of all values in the population. <span class="math display">\[ \mu = \frac{10 + 20 + 30 + 40 + 50}{5} = \frac{150}{5} = 30 \]</span></p></li>
<li><p>List all possible unique samples of size n=2 without replacement.</p></li>
</ol>
<p>There are “5 choose 2” = 10 possible unique samples: 1. <code>(10, 20)</code> 2. <code>(10, 30)</code> 3. <code>(10, 40)</code> 4. <code>(10, 50)</code> 5. <code>(20, 30)</code> 6. <code>(20, 40)</code> 7. <code>(20, 50)</code> 8. <code>(30, 40)</code> 9. <code>(30, 50)</code> 10. <code>(40, 50)</code></p>
<ol start="3" type="a">
<li>Calculate the sample mean (<span class="math inline">\(\bar{x}\)</span>) for each of these possible samples.</li>
</ol>
<!-- -->
<ol type="1">
<li><code>mean(10, 20) = 15</code></li>
<li><code>mean(10, 30) = 20</code></li>
<li><code>mean(10, 40) = 25</code></li>
<li><code>mean(10, 50) = 30</code></li>
<li><code>mean(20, 30) = 25</code></li>
<li><code>mean(20, 40) = 30</code></li>
<li><code>mean(20, 50) = 35</code></li>
<li><code>mean(30, 40) = 35</code></li>
<li><code>mean(30, 50) = 40</code></li>
<li><code>mean(40, 50) = 45</code></li>
</ol>
<!-- -->
<ol start="4" type="a">
<li>Present this distribution as a frequency table. This list of all possible sample means constitutes the exact sampling distribution of the sample mean.</li>
</ol>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Sample Mean (<span class="math inline">\(\bar{x}\)</span>)</th>
<th style="text-align: left;">Frequency</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">15</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">20</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">25</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">30</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">35</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">40</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">45</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Total</strong></td>
<td style="text-align: left;"><strong>10</strong></td>
</tr>
</tbody>
</table>
<ol start="5" type="a">
<li>Is the mean of this sampling distribution equal to the true population mean? Let’s calculate the mean of the sampling distribution (the average of all possible sample means): <span class="math display">\[ \text{Mean of } \bar{x} = \frac{15(1) + 20(1) + 25(2) + 30(2) + 35(2) + 40(1) + 45(1)}{10} \]</span> <span class="math display">\[ = \frac{15 + 20 + 50 + 60 + 70 + 40 + 45}{10} = \frac{300}{10} = 30 \]</span></li>
</ol>
<p><strong>Yes</strong>, the mean of the sampling distribution (30) is exactly equal to the true population mean (<span class="math inline">\(\mu=30\)</span>) calculated in part (a). This demonstrates that the sample mean is an unbiased estimator of the population mean.</p>
</section>
<section id="sec-simulation" class="level2">
<h2 class="anchored" data-anchor-id="sec-simulation">Simulating a Sampling Distribution</h2>
<p>This exercise involves simulating a sampling distribution from a highly skewed Exponential population.</p>
<ol type="a">
<li>Simulate a population A large population of 100,000 data points is drawn from an Exponential distribution with a mean (<span class="math inline">\(\mu\)</span>) of 10. A histogram of this population data would be highly right-skewed, with most values clustered near zero and a long tail extending to the right.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random seed for reproducibility</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># a) Simulate a population of 100,000 data points from Exponential distribution with mean 10</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>population_size <span class="op">=</span> <span class="dv">100000</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>population_mean <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>population <span class="op">=</span> np.random.exponential(scale<span class="op">=</span>population_mean, size<span class="op">=</span>population_size)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="a">
<li>Draw 5,000 different random samples From this skewed population, we draw 5,000 separate random samples, each containing <code>n=50</code> observations.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># b) Draw 5,000 different random samples, each with n=50 observations</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>num_samples <span class="op">=</span> <span class="dv">5000</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>sample_size <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> [np.random.choice(population, size<span class="op">=</span>sample_size, replace<span class="op">=</span><span class="va">False</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_samples)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="a">
<li>For each sample, calculate its sample mean We compute the mean for each of the 5,000 samples, resulting in a list of 5,000 sample means.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># c) Calculate the sample mean for each sample</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>sample_means <span class="op">=</span> [np.mean(sample) <span class="cf">for</span> sample <span class="kw">in</span> samples]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="4" type="a">
<li>Plot a histogram of the 5,000 sample means (While a plot cannot be displayed here, we can describe the result).</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># d) Plot a histogram of the 5,000 sample means</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>plt.hist(sample_means, bins<span class="op">=</span><span class="dv">30</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Sampling Distribution of the Mean (n=50)'</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Sample Mean'</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Frequency'</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="tutorial2_solutions_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print some statistics</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Population mean: </span><span class="sc">{</span>population_mean<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Population mean: 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mean of sample means: </span><span class="sc">{</span>np<span class="sc">.</span>mean(sample_means)<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean of sample means: 9.97</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Standard deviation of sample means: </span><span class="sc">{</span>np<span class="sc">.</span>std(sample_means, ddof<span class="op">=</span><span class="dv">1</span>)<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Standard deviation of sample means: 1.42</code></pre>
</div>
</div>
<ol start="5" type="a">
<li>Describe the shape of the histogram of sample means.</li>
</ol>
<p>Even though the original population has a highly skewed Exponential distribution, the histogram of the 5,000 sample means will <strong>look like a Normal distribution</strong>. It will be bell-shaped, symmetric, and centered around the true population mean of 10.</p>
<p>This is a direct consequence of the <strong>Central Limit Theorem (CLT)</strong>, which states that for a sufficiently large sample size (n=50 is large enough), the sampling distribution of the sample mean will be approximately normal, regardless of the shape of the original population distribution.</p>
</section>
<section id="applying-the-clt-conceptually" class="level2">
<h2 class="anchored" data-anchor-id="applying-the-clt-conceptually">Applying the CLT Conceptually</h2>
<p>Given a right-skewed population distribution of package weights with a true mean <span class="math inline">\(\mu = 8\)</span> kg and a true standard deviation <span class="math inline">\(\sigma = 5\)</span> kg. A random sample of <code>n=100</code> is taken.</p>
<ol type="a">
<li>According to the Central Limit Theorem, what can you say about the shape of the sampling distribution of the sample mean weight (<span class="math inline">\(\bar{x}\)</span>)?</li>
</ol>
<p>Because the sample size <code>n=100</code> is large (well above the common threshold of 30), the Central Limit Theorem applies. Therefore, the sampling distribution of the sample mean (<span class="math inline">\(\bar{x}\)</span>) will be <strong>approximately Normal</strong>, despite the population itself being right-skewed.</p>
<ol start="2" type="a">
<li>What will be the theoretical mean of this sampling distribution?</li>
</ol>
<p>The mean of the sampling distribution of the sample mean is always equal to the population mean. <span class="math display">\[ \text{Mean}(\bar{x}) = \mu = 8 \text{ kg} \]</span></p>
<ol start="3" type="a">
<li>What will be the theoretical standard deviation of this sampling distribution (i.e., the standard error)?</li>
</ol>
<p>The standard deviation of the sampling distribution is called the standard error (SE) and is calculated as <span class="math inline">\(\sigma / \sqrt{n}\)</span>. <span class="math display">\[ SE = \frac{\sigma}{\sqrt{n}} = \frac{5}{\sqrt{100}} = \frac{5}{10} = 0.5 \text{ kg} \]</span></p>
</section>
<section id="verifying-the-clt-in-pythonrstata" class="level2">
<h2 class="anchored" data-anchor-id="verifying-the-clt-in-pythonrstata">Verifying the CLT in Python/R/Stata</h2>
<p>Using the simulation from the Exponential population with true mean <span class="math inline">\(\mu=10\)</span>, true standard deviation <span class="math inline">\(\sigma=10\)</span>, and sample size <code>n=50</code>.</p>
<ol type="a">
<li>From the list of 5,000 sample means you generated, calculate the <em>empirical mean</em> and the <em>empirical standard deviation</em>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the random seed for reproducibility (same as before)</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>population_mean <span class="op">=</span> <span class="dv">10</span>  <span class="co"># μ</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>population_std <span class="op">=</span> <span class="dv">10</span>   <span class="co"># σ (for Exponential distribution, σ = μ)</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>sample_size <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>num_samples <span class="op">=</span> <span class="dv">5000</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample means</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> [np.random.choice(population, size<span class="op">=</span>sample_size, replace<span class="op">=</span><span class="va">False</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_samples)]</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>sample_means <span class="op">=</span> [np.mean(sample) <span class="cf">for</span> sample <span class="kw">in</span> samples]</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co"># a) Calculate empirical mean and standard deviation of sample means</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>empirical_mean <span class="op">=</span> np.mean(sample_means)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>empirical_std <span class="op">=</span> np.std(sample_means, ddof<span class="op">=</span><span class="dv">1</span>)  <span class="co"># Using ddof=1 for sample standard deviation</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>empirical_mean<span class="sc">:.3f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>9.945</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>empirical_std<span class="sc">:.3f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.388</code></pre>
</div>
</div>
<ol start="2" type="a">
<li>According to the CLT, what <em>should</em> the theoretical mean of the sampling distribution be?</li>
</ol>
<p>The theoretical mean of the sampling distribution is the population mean, <span class="math inline">\(\mu=10\)</span>.</p>
<ol start="3" type="a">
<li>According to the CLT, what <em>should</em> the theoretical standard deviation of the sampling distribution (the standard error) be?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>theoretical_se <span class="op">=</span> population_std <span class="op">/</span> np.sqrt(sample_size)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>theoretical_se<span class="sc">:.3f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.414</code></pre>
</div>
</div>
<p>The theoretical standard error (SE) is <span class="math inline">\(\sigma / \sqrt{n}\)</span>. <span class="math display">\[ \text{Theoretical SE} = \frac{\sigma}{\sqrt{n}} = \frac{10}{\sqrt{50}} \approx \frac{10}{7.071} \approx 1.414 \]</span></p>
<ol start="4" type="a">
<li>Compare the empirical results from part (a) with the theoretical results from parts (b) and (c). Are they close?</li>
</ol>
<p>Yes, they’re almost equal. This comparison demonstrates how a simulation can empirically verify the predictions of the Central Limit Theorem.</p>
</section>
<section id="formulating-hypotheses" class="level2">
<h2 class="anchored" data-anchor-id="formulating-hypotheses">Formulating Hypotheses</h2>
<ul>
<li>Scenario A: Water Consumption</li>
</ul>
<p>A city’s water department wants to know if the average daily water consumption per household has <strong>changed</strong> from last year’s average of 350 gallons.</p>
<ul>
<li><p><strong>Hypotheses:</strong></p>
<ul>
<li><span class="math inline">\(H_0: \mu = 350\)</span> (The mean consumption has not changed).</li>
<li><span class="math inline">\(H_A: \mu \neq 350\)</span> (The mean consumption has changed).</li>
</ul></li>
<li><p><strong>Test Type:</strong> <strong>Two-sided test</strong>.</p></li>
<li><p><strong>Justification:</strong> The keyword is “changed,” which does not specify a direction (increase or decrease). The department is interested in detecting a significant change in either direction.</p></li>
<li><p>Scenario B: New Drug</p></li>
</ul>
<p>A pharmaceutical company wants to test if a new drug is effective, meaning it <strong>reduces</strong> blood pressure compared to a placebo.</p>
<ul>
<li><p><strong>Hypotheses:</strong></p>
<ul>
<li><span class="math inline">\(H_0: \mu \ge \mu_{\text{placebo}}\)</span> (The drug does not reduce blood pressure; it has no effect or makes it worse).</li>
<li><span class="math inline">\(H_A: \mu &lt; \mu_{\text{placebo}}\)</span> (The drug is effective; it reduces blood pressure).</li>
</ul></li>
<li><p><strong>Test Type:</strong> <strong>One-sided test</strong> (specifically, a left-tailed test).</p></li>
<li><p><strong>Justification:</strong> The company is only interested in proving that the drug <em>reduces</em> blood pressure. An outcome where the drug increases blood pressure would lead to the same conclusion as “no effect”: the drug is not marketed. The research question has a clear direction.</p></li>
<li><p>Scenario C: Website Design</p></li>
</ul>
<p>An online retailer wants to know if a new website design has a <strong>different</strong> conversion rate than the old design’s rate of 15%.</p>
<ul>
<li><strong>Hypotheses:</strong>
<ul>
<li><span class="math inline">\(H_0: p = 0.15\)</span> (The new design’s conversion rate is the same as the old one).</li>
<li><span class="math inline">\(H_A: p \neq 0.15\)</span> (The new design’s conversion rate is different).</li>
</ul></li>
<li><strong>Test Type:</strong> <strong>Two-sided test</strong>.</li>
<li><strong>Justification:</strong> The keyword is “different.” The retailer wants to know if the new design has <em>any</em> impact on the conversion rate, whether it’s an improvement (p &gt; 0.15) or a detriment (p &lt; 0.15). Both outcomes are important for their business decision.</li>
</ul>
</section>
<section id="interpretation-and-calculation" class="level2">
<h2 class="anchored" data-anchor-id="interpretation-and-calculation">Interpretation and Calculation</h2>
<p>Given: <code>n=36</code>, <span class="math inline">\(\bar{x} = 48.5\)</span> MPG, <span class="math inline">\(\sigma = 6\)</span> MPG, <span class="math inline">\(\mu_0 = 50\)</span> MPG, <span class="math inline">\(\alpha = 0.05\)</span>. Test if the true mean is less than 50 MPG.</p>
<ol type="a">
<li>State the null (<span class="math inline">\(H_0\)</span>) and alternative (<span class="math inline">\(H_A\)</span>) hypotheses for this test.</li>
</ol>
<ul>
<li><strong>Null Hypothesis (</strong><span class="math inline">\(H_0\)</span>): The manufacturer’s claim is true. <span class="math inline">\(H_0: \mu = 50\)</span></li>
<li><strong>Alternative Hypothesis (</strong><span class="math inline">\(H_A\)</span>): The manufacturer’s claim is overstated (the true mean is lower). <span class="math inline">\(H_A: \mu &lt; 50\)</span></li>
</ul>
<ol start="2" type="a">
<li><p>Calculate the standard error of the sample mean. The standard error (SE) is <span class="math inline">\(\sigma / \sqrt{n}\)</span>. <span class="math display">\[ SE = \frac{6}{\sqrt{36}} = \frac{6}{6} = 1.0 \text{ MPG} \]</span></p></li>
<li><p>Calculate the Z-test statistic.</p></li>
</ol>
<p>The Z-statistic measures how many standard errors the sample mean is from the hypothesized population mean. <span class="math display">\[ Z = \frac{\bar{x} - \mu_0}{SE} = \frac{48.5 - 50}{1.0} = -1.5 \]</span></p>
<ol start="4" type="a">
<li><p>Using your Z-statistic, find the corresponding p-value. Since this is a left-tailed test (<span class="math inline">\(H_A: \mu &lt; 50\)</span>), the p-value is the area under the standard normal curve to the left of Z = -1.5. Using a Z-table or statistical software, we find: <span class="math display">\[ p\text{-value} = P(Z \le -1.5) \approx 0.0668 \]</span></p></li>
<li><p>Based on your p-value and the significance level of <span class="math inline">\(\alpha=0.05\)</span>, what is your conclusion?</p></li>
</ol>
<p>We compare the p-value to the significance level <span class="math inline">\(\alpha\)</span>. * p-value (0.0668) &gt; <span class="math inline">\(\alpha\)</span> (0.05)</p>
<p>Since the p-value is greater than the significance level, we <strong>fail to reject the null hypothesis</strong>.</p>
<p><strong>Conclusion:</strong> At the 5% significance level, there is insufficient statistical evidence to conclude that the true mean fuel efficiency of the new hybrid model is less than 50 MPG. The consumer watchdog group does not have strong enough evidence to refute the manufacturer’s claim.</p>
</section>
<section id="performing-a-hypothesis-test" class="level2">
<h2 class="anchored" data-anchor-id="performing-a-hypothesis-test">Performing a Hypothesis Test</h2>
<p>Use the <code>WAGE2.DTA</code> dataset. Import it in R/Python/Stata. Conduct a hypothesis test on the <code>IQ</code> variable. The null hypothesis is that <code>mu_0 = 100</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_stata(<span class="st">"../datafiles/WAGE2.DTA"</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>mu_0 <span class="op">=</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="a">
<li>Calculate the standard error and the Z-test statistic in Python.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>sigma <span class="op">=</span> np.std(data[<span class="st">'IQ'</span>])</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">len</span>(data[<span class="st">'IQ'</span>])</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>se <span class="op">=</span> sigma <span class="op">/</span> np.sqrt(n)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>sample_mean <span class="op">=</span> np.mean(data[<span class="st">'IQ'</span>])</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> (sample_mean <span class="op">-</span> mu_0) <span class="op">/</span> se</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="a">
<li>The p-value for a two-tailed test is the area under the standard normal curve that is more extreme (on both sides) than your calculated Z-statistic. Use <code>scipy.stats.norm.cdf()</code> or <code>pnorm()</code> to find this p-value.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> norm</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>p_value <span class="op">=</span> (<span class="dv">1</span> <span class="op">-</span> norm.cdf(z)) <span class="op">+</span> norm.cdf(<span class="op">-</span>z)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The p-value is: </span><span class="sc">{</span>p_value<span class="sc">:.3f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The p-value is: 0.009</code></pre>
</div>
</div>
<p>Meaning we reject the null hypothesis that the average IQ in the population is 100.</p>
</section>
<section id="correct-interpretation" class="level2">
<h2 class="anchored" data-anchor-id="correct-interpretation">Correct Interpretation</h2>
<p>Given a 95% confidence interval for average study hours: <strong>[12.5, 15.0]</strong>.</p>
<p>The correct interpretation is <strong>Statement 2</strong>.</p>
<ul>
<li><p><strong>Statement 2 (Correct):</strong> “We are 95% confident that the method we used to generate this interval captures the true average study time for all students at the university.”</p></li>
<li><p>Explanation: This statement is correct because it properly places the “confidence” (which is related to probability) on the <strong>method</strong>, not on the true parameter. The true population mean (<span class="math inline">\(\mu\)</span>) is a fixed, unknown number. It does not vary. What is random is our sampling process. If we were to repeat our sampling procedure 100 times, we would generate 100 different confidence intervals. The “95% confidence” means we expect about 95 of those 100 intervals to successfully “capture” or contain the true, fixed population mean. Our specific interval, [12.5, 15.0], is just one of those results.</p></li>
<li><p><strong>Statement 1 (Incorrect):</strong> “There is a 95% probability that the true average study time for all students at the university is between 12.5 and 15.0 hours.”</p></li>
<li><p>Explanation of Error: This statement is a very common misinterpretation. It incorrectly implies that the true mean <span class="math inline">\(\mu\)</span> is a random variable that has a 95% chance of falling within our calculated interval. But <span class="math inline">\(\mu\)</span> is fixed. Once we have calculated our interval [12.5, 15.0], the true mean <span class="math inline">\(\mu\)</span> is either inside this specific range or it is not. The probability is either 1 or 0, we just don’t know which. The 95% refers to the long-run success rate of the <em>procedure</em> used to create the interval.</p></li>
</ul>
</section>
<section id="factors-affecting-interval-width" class="level2">
<h2 class="anchored" data-anchor-id="factors-affecting-interval-width">Factors Affecting Interval Width</h2>
<p>The width of a confidence interval is determined by the Margin of Error: <code>Width = 2 * (Critical Value) * (Standard Error)</code>.</p>
<ol type="a">
<li>Increasing the confidence level from 90% to 99%.</li>
</ol>
<p>This will make the confidence interval <strong>wider</strong>. To be more confident that you have captured the true mean, you need to use a larger critical value (e.g., Z for 99% is ~2.576 vs.&nbsp;~1.645 for 90%). A larger critical value increases the margin of error, thus widening the interval. Think of it as needing a wider net to be more sure of catching the fish.</p>
<ol start="2" type="a">
<li>Increasing the sample size from 100 to 400.</li>
</ol>
<p>This will make the confidence interval <strong>narrower</strong>. The sample size (<code>n</code>) is in the denominator of the standard error (<span class="math inline">\(\sigma/\sqrt{n}\)</span>). Increasing <code>n</code> decreases the standard error. A smaller standard error results in a smaller margin of error and a more precise, narrower interval. More data provides a more accurate estimate.</p>
<ol start="3" type="a">
<li>The sample having a larger standard deviation.</li>
</ol>
<p>This will make the confidence interval <strong>wider</strong>. The standard deviation (<span class="math inline">\(\sigma\)</span>) is in the numerator of the standard error. A larger standard deviation indicates that the data points in the population are more spread out and variable. This increased variability leads to a larger standard error, a larger margin of error, and thus a wider interval to account for the greater uncertainty.</p>
</section>
<section id="constructing-a-confidence-interval" class="level2">
<h2 class="anchored" data-anchor-id="constructing-a-confidence-interval">Constructing a Confidence Interval</h2>
<p>Given: <code>n=36</code>, <span class="math inline">\(\bar{x} = 48.5\)</span> MPG, <span class="math inline">\(\sigma = 6\)</span> MPG.</p>
<ol type="a">
<li>Calculate a 95% confidence interval for the true mean fuel efficiency.</li>
</ol>
<p>Here is a Python script demonstrating the calculation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> norm</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Given data</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>x_bar <span class="op">=</span> <span class="fl">48.5</span>  <span class="co"># Sample mean</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>sigma <span class="op">=</span> <span class="dv">6</span>     <span class="co"># Population standard deviation</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">36</span>        <span class="co"># Sample size</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>confidence_level <span class="op">=</span> <span class="fl">0.95</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Point estimate is the sample mean</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>point_estimate <span class="op">=</span> x_bar</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Calculate the standard error</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>standard_error <span class="op">=</span> sigma <span class="op">/</span> np.sqrt(n)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Find the critical Z-value for a 95% CI</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co"># We need to leave (1 - 0.95)/2 = 0.025 in each tail.</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="co"># So we look for the Z-value at the 0.975 percentile.</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>critical_value <span class="op">=</span> norm.ppf(<span class="dv">1</span> <span class="op">-</span> (<span class="dv">1</span> <span class="op">-</span> confidence_level) <span class="op">/</span> <span class="dv">2</span>) <span class="co"># Equivalent to norm.ppf(0.975)</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Calculate the margin of error</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>margin_of_error <span class="op">=</span> critical_value <span class="op">*</span> standard_error</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Construct the interval</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>lower_bound <span class="op">=</span> point_estimate <span class="op">-</span> margin_of_error</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>upper_bound <span class="op">=</span> point_estimate <span class="op">+</span> margin_of_error</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Point Estimate: </span><span class="sc">{</span>point_estimate<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Point Estimate: 48.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Standard Error: </span><span class="sc">{</span>standard_error<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Standard Error: 1.00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Critical Z-value: </span><span class="sc">{</span>critical_value<span class="sc">:.3f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Critical Z-value: 1.960</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Margin of Error: </span><span class="sc">{</span>margin_of_error<span class="sc">:.3f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Margin of Error: 1.960</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"95% Confidence Interval: [</span><span class="sc">{</span>lower_bound<span class="sc">:.3f}</span><span class="ss">, </span><span class="sc">{</span>upper_bound<span class="sc">:.3f}</span><span class="ss">]"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% Confidence Interval: [46.540, 50.460]</code></pre>
</div>
</div>
<ol start="2" type="a">
<li>Now, calculate a 99% confidence interval using the same data.</li>
</ol>
<p>We only need to change the confidence level and find the new critical value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>critical_value <span class="op">=</span> norm.ppf(<span class="fl">0.995</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>margin_of_error <span class="op">=</span> critical_value <span class="op">*</span> standard_error</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>lower_bound <span class="op">=</span> x_bar <span class="op">-</span> margin_of_error</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>upper_bound <span class="op">=</span> x_bar <span class="op">+</span> margin_of_error</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Critical Z-value: </span><span class="sc">{</span>critical_value<span class="sc">:.3f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Critical Z-value: 2.576</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Margin of Error: </span><span class="sc">{</span>margin_of_error<span class="sc">:.3f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Margin of Error: 2.576</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"95% Confidence Interval: [</span><span class="sc">{</span>lower_bound<span class="sc">:.3f}</span><span class="ss">,</span><span class="sc">{</span>upper_bound<span class="sc">:.3f}</span><span class="ss">]"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% Confidence Interval: [45.924,51.076]</code></pre>
</div>
</div>
<p>As expected, the <strong>99% confidence interval is wider</strong> than the 95% confidence interval. This is because we require a wider range to be more confident that it contains the true population mean.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>